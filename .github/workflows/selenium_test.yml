name: Regresi贸n Visual TN

on:
  # Desencadena el flujo de trabajo manualmente
  workflow_dispatch:
    inputs:
      version_number:
        description: 'N煤mero de Versi贸n (Ej: 170)'
        required: true
        default: '999'

jobs:
  run_regression:
    runs-on: ubuntu-latest
    
    steps:
    - name: 猬锔 Checkout del C贸digo
      uses: actions/checkout@v4

    # 1. Instalar Google Chrome (Necesario para Selenium en headless)
    - name: 锔 Instalar Google Chrome Headless
      run: |
        sudo apt-get update
        sudo apt-get install -y google-chrome-stable

    # 2. Configurar Python
    - name:  Configurar Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.x' 

    # 3. Instalar dependencias de Python
    - name:  Instalar Dependencias
      run: |
        pip install --upgrade pip
        if [ -f requirements.txt ]; then
            pip install -r requirements.txt
        else
            echo "El archivo requirements.txt no se encontr贸."
            exit 1
        fi

    # 4. Ejecutar el Script de Regresi贸n
    - name:  Ejecutar Regresi贸n Visual
      id: run_script
      # El script requiere el n煤mero de versi贸n como argumento
      run: |
        # Ejecuta el script con el argumento proporcionado en el input
        python regre_visual_tn_desk_prod.py ${{ github.event.inputs.version_number }}
        
    # 5. Cargar los Reportes y Capturas como Artefactos
    # Esto es CRTICO para poder ver los resultados fuera de la m谩quina virtual de GitHub
    - name:  Cargar Reportes como Artefacto
      uses: actions/upload-artifact@v4
      with:
        name: reportes-regresion-${{ github.event.inputs.version_number }}
        path: Reportes HTML - TN - DESKTOP - PROD/
        retention-days: 7 # D铆as que se mantendr谩 el artefacto
